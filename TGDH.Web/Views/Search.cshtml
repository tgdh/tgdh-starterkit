@inherits UmbracoViewPage<IPublishedContent>
@{
    Layout = "Master.cshtml";
    var headline = Model.GetPropertyValue<string>("headline", Model.Name);

    var query = Request.QueryString["q"];
    if (query.IsNullOrWhiteSpace()) {
        return;
    }

    var results = Umbraco.TypedSearch(query);
}

<main class="o-page__inner u-clearfix" role="main">
	<h1>@headline</h1>

    @Html.Partial("Forms/SearchForm")
    <section class="m-search-results">
        @if (results != null && results.Any()) {
            <small>@results.Count() results for <strong>@query</strong></small>

            foreach (var item in results) {
                @Html.Partial("Components/Card", new CardViewModel {
                    Headline = item.GetPropertyValue<string>("headline", item.Name),
                    Url = item.Url,
                    Image = Umbraco.TypedMedia(item.GetPropertyValue<int>("featuredImage"))
                })
            }
        } else {
            <p>Sorry, we couldn't find anything for <strong>@query</strong></p>
        }
    </section>
</main>
